#!/usr/bin/env bash

set -euo pipefail

readonly SCRIPT_DIR_PATH="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
readonly SCRIPT_FILE_NAME="$(basename "$0")"
readonly SCRIPT_FILE_PATH="$SCRIPT_DIR_PATH/$SCRIPT_FILE_NAME"

readonly baseDirPath=$(dirname "$SCRIPT_DIR_PATH")
readonly backendModuleDirPath=$baseDirPath/server
readonly frontendModuleDirPath=$baseDirPath/client

js() {
    tsc --build "$frontendModuleDirPath"/tsconfig.json
}

css() {
    local -r inCssDirPath="$frontendModuleDirPath"/localhost/rc/css
    local -r outCssDirPath=$inCssDirPath
    # To compress add the `-c` option
    mkdir -p "$outCssDirPath"
    cd "$inCssDirPath" && stylus -I "$frontendModuleDirPath"/node_modules/bootstrap-styl --disable-cache < index.styl > "$outCssDirPath"/index.css
    cd "$inCssDirPath" && stylus --disable-cache < test.styl > "$outCssDirPath"/test.css
}

"$@"

